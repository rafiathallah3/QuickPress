{"version":3,"sources":["../src/popup.ts"],"sourcesContent":["export {};\r\n\r\ntype ShortcutConfig = {\r\n  ctrl: boolean;\r\n  alt: boolean;\r\n  shift: boolean;\r\n  meta: boolean;\r\n  key: string;\r\n};\r\n\r\nconst SHORTCUT_STORAGE_KEY = \"shortcut\";\r\nconst DEFAULT_SHORTCUT: ShortcutConfig = {\r\n  ctrl: true,\r\n  alt: false,\r\n  shift: false,\r\n  meta: false,\r\n  key: \"q\"\r\n};\r\n\r\nconst highlightButton = document.getElementById(\"highlight\") as HTMLButtonElement;\r\nconst statusEl = document.getElementById(\"status\") as HTMLParagraphElement;\r\nconst shortcutForm = document.getElementById(\"shortcut-form\") as HTMLFormElement;\r\nconst keyInput = document.getElementById(\"shortcut-key\") as HTMLInputElement;\r\nconst ctrlInput = document.getElementById(\"shortcut-ctrl\") as HTMLInputElement;\r\nconst altInput = document.getElementById(\"shortcut-alt\") as HTMLInputElement;\r\nconst shiftInput = document.getElementById(\"shortcut-shift\") as HTMLInputElement;\r\nconst metaInput = document.getElementById(\"shortcut-meta\") as HTMLInputElement;\r\nconst shortcutStatus = document.getElementById(\"shortcut-status\") as HTMLParagraphElement;\r\nconst saveShortcutButton = document.getElementById(\"save-shortcut\") as HTMLButtonElement;\r\n\r\nasync function updateStatus(text: string) {\r\n  statusEl.textContent = text;\r\n}\r\n\r\nasync function highlightActiveTab() {\r\n  highlightButton.disabled = true;\r\n  await updateStatus(\"Highlighting...\");\r\n\r\n  try {\r\n    const [tab] = await chrome.tabs.query({ active: true, currentWindow: true });\r\n    if (!tab?.id) {\r\n      await updateStatus(\"No active tab detected.\");\r\n      return;\r\n    }\r\n\r\n    await chrome.tabs.sendMessage(tab.id, { type: \"HIGHLIGHT\" });\r\n    await updateStatus(\"Toggled highlight!\");\r\n  } catch (error) {\r\n    console.error(error);\r\n    await updateStatus(\"Failed to message content script.\");\r\n  } finally {\r\n    highlightButton.disabled = false;\r\n  }\r\n}\r\n\r\nconst sanitizeShortcut = (value: unknown): ShortcutConfig => {\r\n  if (!value || typeof value !== \"object\") {\r\n    return { ...DEFAULT_SHORTCUT };\r\n  }\r\n  const candidate = value as Partial<ShortcutConfig> & { key?: string };\r\n  const trimmedKey =\r\n    typeof candidate.key === \"string\" && candidate.key.trim().length > 0\r\n      ? candidate.key.trim().toLowerCase().slice(0, 1)\r\n      : DEFAULT_SHORTCUT.key;\r\n\r\n  return {\r\n    ctrl: Boolean(candidate.ctrl),\r\n    alt: Boolean(candidate.alt),\r\n    shift: Boolean(candidate.shift),\r\n    meta: Boolean(candidate.meta),\r\n    key: trimmedKey\r\n  };\r\n};\r\n\r\nconst setShortcutStatus = (message: string, isError = false) => {\r\n  shortcutStatus.textContent = message;\r\n  shortcutStatus.style.color = isError ? \"#b91c1c\" : \"#1b2430\";\r\n};\r\n\r\nconst applyShortcutToForm = (config: ShortcutConfig) => {\r\n  keyInput.value = config.key.toUpperCase();\r\n  ctrlInput.checked = config.ctrl;\r\n  altInput.checked = config.alt;\r\n  shiftInput.checked = config.shift;\r\n  metaInput.checked = config.meta;\r\n};\r\n\r\nconst loadShortcut = async () => {\r\n  try {\r\n    const stored = await chrome.storage.sync.get(SHORTCUT_STORAGE_KEY);\r\n    const config = sanitizeShortcut(stored?.[SHORTCUT_STORAGE_KEY]);\r\n    applyShortcutToForm(config);\r\n    setShortcutStatus(\"Shortcut ready.\");\r\n  } catch (error) {\r\n    console.error(error);\r\n    applyShortcutToForm(DEFAULT_SHORTCUT);\r\n    setShortcutStatus(\"Failed to load shortcut.\", true);\r\n  }\r\n};\r\n\r\nconst saveShortcut = async (config: ShortcutConfig) => {\r\n  await chrome.storage.sync.set({ [SHORTCUT_STORAGE_KEY]: config });\r\n};\r\n\r\nshortcutForm?.addEventListener(\"submit\", async (event) => {\r\n  event.preventDefault();\r\n  if (!keyInput.value.trim()) {\r\n    setShortcutStatus(\"Please enter a shortcut key.\", true);\r\n    return;\r\n  }\r\n\r\n  const normalizedKey = keyInput.value.trim().toLowerCase().slice(0, 1);\r\n  if (!/^[a-z0-9]$/.test(normalizedKey)) {\r\n    setShortcutStatus(\"Use a letter or digit for the key.\", true);\r\n    return;\r\n  }\r\n\r\n  const nextShortcut: ShortcutConfig = {\r\n    ctrl: ctrlInput.checked,\r\n    alt: altInput.checked,\r\n    shift: shiftInput.checked,\r\n    meta: metaInput.checked,\r\n    key: normalizedKey\r\n  };\r\n\r\n  saveShortcutButton.disabled = true;\r\n  setShortcutStatus(\"Saving shortcut...\");\r\n\r\n  try {\r\n    await saveShortcut(nextShortcut);\r\n    setShortcutStatus(\"Shortcut saved!\");\r\n  } catch (error) {\r\n    console.error(error);\r\n    setShortcutStatus(\"Failed to save shortcut.\", true);\r\n  } finally {\r\n    saveShortcutButton.disabled = false;\r\n  }\r\n});\r\n\r\nchrome.storage.onChanged.addListener((changes, areaName) => {\r\n  if (areaName === \"sync\" && SHORTCUT_STORAGE_KEY in changes) {\r\n    const change = changes[SHORTCUT_STORAGE_KEY];\r\n    if (change?.newValue) {\r\n      applyShortcutToForm(sanitizeShortcut(change.newValue));\r\n      setShortcutStatus(\"Shortcut updated.\");\r\n    }\r\n  }\r\n});\r\n\r\nhighlightButton?.addEventListener(\"click\", () => {\r\n  highlightActiveTab();\r\n});\r\n\r\nloadShortcut();\r\n"],"mappings":"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","names":[]}